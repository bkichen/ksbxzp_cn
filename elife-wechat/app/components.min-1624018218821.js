"use strict";!function(){function atClassCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,21,"gt")?void setValidity("length"):VALIDATION.atClassCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("atClassCheck",atClassCheck),atClassCheck.$inject=["VALIDATION"]}(),function(){function addressCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["invalid","length","number","addressA","addressB","addressC","addressD"];if(!value)return void setValidity();if(!VALIDATION.addressCheck(value))return void setValidity("invalid");if(VALIDATION.stringLengthCheck(value,4,"lt")||VALIDATION.stringLengthCheck(value,50,"gt"))return void setValidity("length");if(!VALIDATION.numberCheck(value))return void setValidity("number");if(attr.isaddress){if(console.info("isaddress=="+attr.isaddress),!VALIDATION.addressD(value))return void(value&&setValidity("addressD"));if(!VALIDATION.addressA(value))return void(value&&setValidity("addressA"));if(!VALIDATION.addressB(value))return void(value&&setValidity("addressB"));if(!VALIDATION.addressC(value))return void(value&&setValidity("addressC"))}setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("addressCheck",addressCheck),addressCheck.$inject=["VALIDATION"]}(),function(){function atSchoolCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,51,"gt")?void setValidity("length"):VALIDATION.atSchoolCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("atSchoolCheck",atSchoolCheck),atSchoolCheck.$inject=["VALIDATION"]}(),function(){function policyCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,20,"gt")?void setValidity("length"):VALIDATION.policyCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("policyCheck",policyCheck),policyCheck.$inject=["VALIDATION"]}(),function(){function banknoCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["invalid","length"];return value?VALIDATION.banknoCheck(value)?VALIDATION.stringLengthCheck(value,13,"lt")||VALIDATION.stringLengthCheck(value,28,"gt")?void setValidity("length"):void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("banknoCheck",banknoCheck),banknoCheck.$inject=["VALIDATION"]}(),function(){function cardInvoiceCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,31,"gt")?void setValidity("length"):VALIDATION.wordlineCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("cardInvoiceCheck",cardInvoiceCheck),cardInvoiceCheck.$inject=["VALIDATION"]}(),function(){function contractDragCode($compile,$timeout,CommonRequest,CONFIG,$rootScope){function linkFunc(scope,elem,attrs){function timedCount(){scope.duration<=0?(clearTimeout(time),elem.removeAttr("disabled"),elem.html("重新获取")):time=$timeout(function(){scope.duration--,angular.element(elem).html(scope.duration+"S"),timedCount()},1e3)}function countDown(){elem.attr("disabled","disabled"),scope.duration=attrs.duration,timedCount()}var time,imagecode;$rootScope.$on("drag-down",function(event,result){imagecode=result.position}),elem.bind("click",function(){countDown()})}var directive={restrict:"A",scope:{duration:"@"},link:linkFunc};return directive}angular.module("app").directive("contractDragCode",contractDragCode),contractDragCode.$inject=["$compile","$timeout","CommonRequest","CONFIG","$rootScope"]}(),function(){function commonFlow(){function commonFlowController($scope){for(var text=$scope.text,arr=text.split(","),steps=[],i=0;i<arr.length;i++)steps.push({text:arr[i]});$scope.steps=steps}return{restrict:"E",transclude:!0,scope:{text:"@",current:"@"},templateUrl:"app/components/common-flow/common-flow.html",controller:commonFlowController}}angular.module("app").directive("commonFlow",commonFlow)}(),function(){function disablePaste(){function linkFunc(scope,elem){elem.on("paste",function(e){e.preventDefault()}),elem.on("copy",function(e){e.preventDefault()})}var directive={restrict:"A",link:linkFunc};return directive}angular.module("app").directive("disablePaste",disablePaste),disablePaste.$inject=[]}(),function(){function dateCheck(VALIDATION,$filter){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){if(!value)return ngModel.$setValidity("min",!0),void ngModel.$setValidity("max",!0);value=$filter("date")(value,"yyyy-MM-dd");var min=new Date(attr.mintime),max=new Date(attr.maxtime);value=new Date(value),value.getTime()>max.getTime()?ngModel.$setValidity("max",!1):ngModel.$setValidity("max",!0),value.getTime()<min.getTime()?ngModel.$setValidity("min",!1):ngModel.$setValidity("min",!0)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("dateCheck",dateCheck),dateCheck.$inject=["VALIDATION","$filter"]}(),function(){function dragPuzzle($rootScope,$timeout){function linkFunc(scope,element,attr){var disX,position,maxLeft,beginTime,dragWidth,distance2Top,imgDragVerifyDeviation,imgWidthRate,imgHeightRate,element=$(element),bgDrag=$(element.find(".bg-drag")[0]),drag=$(element.find(".drag")[0]),dragSquare=$(element.find(".drag-square")[0]),dragSquareDisabled=$(element.find(".drag-square")[1]),progress=$(element.find(".drag-progress")[0]),slider=$(element.find(".drag-slider")[0]),slider2=$(element.find(".drag-slider-2")[0]),minLeft=0,disabled=!1,originWidth=690,originHeight=200,passShelter=$('<div class="shelter-pass"><p></p></div>'),errorTimes=0,errorText="失败过多,点击右上角刷新按钮重试";scope.$on("drag-start",function(event,result){disabled=!1,passShelter.css("display","none"),dragSquare.removeClass("drag-pass"),dragSquareDisabled.css("display","block"),dragSquareDisabled.css("left","0px"),dragSquareDisabled.removeClass("drag-pass"),progress.removeClass("drag-progress-pass"),progress.css("width","0px"),dragSquare.css("left","0px"),drag.css("left","2px"),dragSquare.css("display","block"),errorTimes=0,slider.removeClass("drag-progress-error"),slider.text(""),slider2.css("display","block"),imgDragVerifyDeviation=result.imgDragVerifyDeviation,dragWidth=result.dragWidth,distance2Top=result.distance2Top}),bgDrag.on("load",function(){maxLeft=bgDrag.width()-drag.width(),imgWidthRate=bgDrag.width()/originWidth,imgHeightRate=bgDrag.height()/originHeight,dragWidth=(dragWidth/3-imgDragVerifyDeviation)*imgWidthRate,distance2Top=(distance2Top*imgHeightRate).toFixed(0),drag.css("top",distance2Top+"px")}),dragSquare.on("touchstart",function(e){disabled||(beginTime=new Date,disX=e.originalEvent.changedTouches[0].clientX-dragSquare.position().left)}),dragSquare.on("touchmove",function(e){disabled||dragSquare.hasClass("drag-error")||(dragSquare.position().left<minLeft?(progress.css("width","0px"),drag.css("left","0px")):dragSquare.position().left>maxLeft?(progress.css("width",maxLeft+20+"px"),drag.css("left",maxLeft+"px")):(progress.css("width",e.originalEvent.changedTouches[0].clientX-disX+20+"px"),dragSquare.css("left",e.originalEvent.changedTouches[0].clientX-disX+"px"),drag.css("left",e.originalEvent.changedTouches[0].clientX-disX+"px")))}),dragSquare.on("touchend",function(e){if(!disabled&&(position=dragSquare.position().left/imgWidthRate,!dragSquare.hasClass("drag-error")))if(dragSquare.position().left>dragWidth-imgDragVerifyDeviation*imgWidthRate&&dragSquare.position().left<dragWidth+imgDragVerifyDeviation*imgWidthRate){var endTime=new Date,usedTime=parseInt(endTime-beginTime)/1e3,passText="太棒了!<br/>您仅用了"+usedTime+"秒就完成了验证!";passShelter=$('<div class="shelter-pass"><p>'+passText+"</p></div>"),passShelter.css("display","block"),dragSquareDisabled.css("left",dragSquare.position().left+"px"),dragSquareDisabled.addClass("drag-pass"),dragSquare.addClass("drag-pass"),progress.addClass("drag-progress-pass"),passShelter.insertAfter(bgDrag),$rootScope.$broadcast("drag-down",{position:position.toFixed(0),disabled:disabled})}else errorTimes>=3?(dragSquare.css("display","none"),dragSquareDisabled.css("display","none"),slider.addClass("drag-progress-error"),progress.css("width","0px"),slider.text(errorText),slider2.css("display","none")):(errorTimes++,dragSquare.addClass("drag-error"),progress.addClass("drag-progress-error"),slider2.css("display","none"),$timeout(function(){dragSquare.animate({left:"0"},500),drag.animate({left:"2"},500),progress.animate({width:"20px"},500)},500),$timeout(function(){dragSquare.removeClass("drag-error"),progress.removeClass("drag-progress-error")},1e3))})}var directive={restrict:"A",require:"?ngModel",link:linkFunc};return directive}angular.module("app").directive("dragPuzzle",dragPuzzle),dragPuzzle.$inject=["$rootScope","$timeout"]}(),function(){function emailCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["invalid","length"];return value?VALIDATION.emailCheck(value)?VALIDATION.stringLengthCheck(value,41,"gt")?void setValidity("length"):void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("emailCheck",emailCheck),emailCheck.$inject=["VALIDATION"]}(),function(){function fileUpload(){function linkFunc(scope,elem,attr,ngModel){elem.bind("change",function(e){var files=e.target.files;if(files.length){var file=files[0],reader=new FileReader;/text\/\w+/.test(file.type)?(reader.onload=function(){angular.element(e.target).next(".upload-img").html("<pre>"+this.result+"</pre>")},reader.readAsText(file)):/image\/\w+/.test(file.type)&&(reader.onload=function(){angular.element(e.target).next(".upload-img").html('<img src="'+this.result+'"/>')},reader.readAsDataURL(file))}})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("fileUpload",fileUpload),fileUpload.$inject=[]}(),function(){function idCheck(VALIDATION,$log){function linkFunc(scope,elem,attr,ngModel){function checkid(value){var typeArray=["invalid","length","invalid2"];if($log.info(value),console.log("length"+value),"R"==attr.idtype)ngModel.$setValidity("rr",!0),value?(value.length>18?(console.info(1111111111),ngModel.$setValidity("length",!1),ngModel.$setValidity("invalid",!0),ngModel.$setValidity("invalid2",!0)):value.length<18?(console.info(22222222),ngModel.$setValidity("invalid2",!1),ngModel.$setValidity("length",!0),ngModel.$setValidity("invalid",!0)):patter.test(value)?(console.info(33333333333),ngModel.$setValidity("invalid",!0),ngModel.$setValidity("invalid2",!0),ngModel.$setValidity("length",!0)):(console.info(4444444444444),ngModel.$setValidity("invalid",!1),ngModel.$setValidity("length",!0),ngModel.$setValidity("invalid2",!0)),console.info(ngModel)):(console.info("hgvhgvgh"),ngModel.$setValidity("invalid",!0),ngModel.$setValidity("length",!0),ngModel.$setValidity("invalid2",!0));else{var setValidity=function(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)};if(ngModel.$setValidity("rr",!0),!value)return void setValidity();if(VALIDATION.chineseCheck(value))return void setValidity("invalid");if(!VALIDATION.stringLengthCheck(value,22,"lt"))return void setValidity("length");var idtype=attr.idtype,checkN=attr.checkn;if("A"!=idtype)if(checkN&&"N"==idtype){if(!VALIDATION.stringLengthCheck(value,15,"gt"))return void setValidity("invalid2");if(!VALIDATION.stringLengthCheck(value,15,"lt"))return void setValidity("invalid2");if(!VALIDATION.wordCheck(value))return void setValidity("invalid2")}else{if(!VALIDATION.stringLengthCheck(value,8,"gt"))return void setValidity("invalid2");if(!VALIDATION.wordCheck(value))return void setValidity("invalid2")}else if(!VALIDATION.idCheck(value))return void setValidity("invalid2");setValidity()}}elem.on("input",function(e){var model=attr.ngModel;-1!=model.indexOf(".")?(model=model.split("."),scope[model[0]][model[1]]=e.target.value):scope[attr.ngModel]=e.target.value,checkid(e.target.value)});var patter=/[a-zA-Z0-9]{18}/i;scope.$watch(attr.ngModel,function(value){checkid(value)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("idCheck",idCheck),idCheck.$inject=["VALIDATION","$log"]}(),function(){function expireBanknoCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var val,typeArray=["invalid","length"];return(val=value?value.replace(/\s/g,""):"")?VALIDATION.banknoCheck(val)?VALIDATION.stringLengthCheck(val,13,"lt")||VALIDATION.stringLengthCheck(val,28,"gt")?void setValidity("length"):void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("expireBanknoCheck",expireBanknoCheck),expireBanknoCheck.$inject=["VALIDATION"]}(),function(){function inputClear(){function linkFunc(scope,elem,attr){var clearBtn=$('<div class="clear-out hide"></div>');clearBtn.insertAfter(elem),clearBtn.on("click",function(){scope.$apply(function(){var model=attr.ngModel;-1!=model.indexOf(".")?(model=model.split("."),scope[model[0]][model[1]]=""):scope[attr.ngModel]=""})}),scope.$watch(attr.ngModel,function(value){var disabledModel=attr.ngDisabled,disabled=!1;disabledModel&&(-1!=disabledModel.indexOf(".")?(disabledModel=disabledModel.split("."),disabled=scope[disabledModel[0]][disabledModel[1]]):disabled=scope[disabledModel]),value&&!disabled?clearBtn.show():clearBtn.hide()})}var directive={restrict:"A",link:linkFunc};return directive}angular.module("app").directive("inputClear",inputClear),inputClear.$inject=[]}(),function(){function inputFocus(){function linkFunc(scope,elem,attr){elem.on("click",function(e){})}var directive={restrict:"A",link:linkFunc};return directive}angular.module("app").directive("inputFocus",inputFocus),inputFocus.$inject=[]}(),function(){function invalidStringCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.invalidStringCheck(value)?ngModel.$setValidity("invalid",!0):ngModel.$setValidity("invalid",!1)):void ngModel.$setValidity("invalid",!0)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("invalidStringCheck",invalidStringCheck),invalidStringCheck.$inject=["VALIDATION"]}(),function(){function invoiceClassCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,60,"gt")?void setValidity("length"):VALIDATION.invoiceClassCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("invoiceClassCheck",invoiceClassCheck),invoiceClassCheck.$inject=["VALIDATION"]}(),function(){function invoiceName(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.invoiceCheck(value)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,30,"lt")?ngModel.$setValidity("length",!0):ngModel.$setValidity("length",!1)):ngModel.$setValidity("invalid",!1)):(ngModel.$setValidity("invalid",!0),void ngModel.$setValidity("length",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("invoiceName",invoiceName),invoiceName.$inject=["VALIDATION"]}(),function(){function medicalCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["invalid","length"];return value?VALIDATION.wordCheck(value)?VALIDATION.stringLengthCheck(value,31,"gt")?void setValidity("length"):void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("medicalCheck",medicalCheck),medicalCheck.$inject=["VALIDATION"]}(),function(){function medicareCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["invalid","length"];return value?VALIDATION.wordCheck(value)?VALIDATION.stringLengthCheck(value,17,"gt")?void setValidity("length"):void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("medicareCheck",medicareCheck),medicareCheck.$inject=["VALIDATION"]}(),function(){function moneyCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){var checkMoney=function(value){function checkMin(){var min=attr.min;min&&parseFloat(min)>parseFloat(value)?ngModel.$setValidity("min",!1):ngModel.$setValidity("min",!0)}function checkMax(){var max=attr.max;return 0===max||"0"===max?void ngModel.$setValidity("max",!0):void(max&&parseFloat(max)<parseFloat(value)?ngModel.$setValidity("max",!1):ngModel.$setValidity("max",!0))}function checkincome(){return VALIDATION.incomeCheck(value)}if(!value)return ngModel.$setValidity("invalid",!0),ngModel.$setValidity("format",!0),ngModel.$setValidity("min",!0),void ngModel.$setValidity("max",!0);if(VALIDATION.moneyCheck(value)){ngModel.$setValidity("invalid",!0);var multiple=attr.multi,income=attr.income;multiple?VALIDATION.multipleCheck(value,multiple)?(ngModel.$setValidity("format",!0),parseFloat(value)!=attr.minmon&&(checkMin(),checkMax())):(ngModel.$setValidity("format",!1),ngModel.$setValidity("min",!0),ngModel.$setValidity("max",!0)):parseFloat(value)!=attr.minmon&&(checkMin(),checkMax()),income&&(checkincome()?ngModel.$setValidity("invalid",!0):ngModel.$setValidity("invalid",!1))}else ngModel.$setValidity("invalid",!1)};scope.$watch(attr.ngModel,function(value){checkMoney(value)}),scope.$watch(attr.minBuyQautity,function(){var value=attr.value;value&&checkMoney(value)}),scope.$watch(attr.maxBuyQautity,function(){var value=attr.value;value&&checkMoney(value)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("moneyCheck",moneyCheck),moneyCheck.$inject=["VALIDATION"]}(),function(){function nameCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.stringCheck(value)&&VALIDATION.invalidStringCheck(value)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,30,"lt")?ngModel.$setValidity("length",!0):ngModel.$setValidity("length",!1)):ngModel.$setValidity("invalid",!1)):(ngModel.$setValidity("invalid",!0),void ngModel.$setValidity("length",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("nameCheck",nameCheck),nameCheck.$inject=["VALIDATION"]}(),function(){function nationfilterSearch($ionicModal,CommonRequest,CONFIG){function linkFunc(scope,element,attr,ngModel){function getFilterList(val){var arr=[];if(scope.NationalList)for(var i=0;i<scope.NationalList.length;i++)-1!=scope.NationalList[i].countryName.indexOf(val)&&arr.push(scope.NationalList[i]);return arr}$ionicModal.fromTemplateUrl("app/components/nation-filter-search/nation-filter-search.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){scope.isFlag=!0,scope.modal.hide()},scope.isFlag=!0,scope.nationExpireName="",scope.eventName=attr.nationFilterSearch,"[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("nationFilterSearch arguments must be String type and the value can not null"),scope.nationBlur=function(e){e.target.value||scope.NationalList&&(scope.areas=scope.NationalList.filter(function(val){return val}))},scope.showModal=function(){scope.modal.show(),scope.NationalList&&(scope.areas=scope.NationalList.filter(function(val){return val}))},scope.returnPreArea=function(){scope.hideModal()},scope.initNation=function(){var config={url:"../statics/json/CRScountry.json",method:"GET"};CommonRequest.request({},config,function(result){scope.NationalList=scope.filterNationalList(scope.idType,result.data),scope.areas=scope.NationalList.filter(function(val){return val})})},scope.filterNationalList=function(idtype,data){var arr=[];return arr="0"==idtype?[{countryName:"中国",countryCode:"CHN"}]:"6"==idtype?[{countryName:"中国香港",countryCode:"HKG"},{countryName:"中国澳门",countryCode:"MAC"},{countryName:"中国台湾",countryCode:"TWN"}]:data.filter(function(obj){return"CHN"!=obj.countryCode&&"HKG"!=obj.countryCode&&"MAC"!=obj.countryCode&&"TWN"!=obj.countryCode})},scope.selectNation=function(obj){ngModel&&(ngModel.$setViewValue(obj.countryName),ngModel.$render()),scope.eventName&&scope.$emit(scope.eventName,obj),scope.inputNation="",scope.isFlag=!1,scope.hideModal()},scope.nationFocus=function(e,val){"focus"==val?(scope.isFlag=!0,scope.NationalList&&(e.target.value?scope.areas=getFilterList(e.target.value):scope.areas=scope.NationalList.filter(function(val){return val}))):"keyup"==val&&(e.target.value?scope.NationalList&&(scope.areas=getFilterList(e.target.value)):scope.NationalList&&(scope.areas=scope.NationalList.filter(function(val){return val})))},scope.initNation(),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectedArea:"=selectArea",idType:"=idtype"},link:linkFunc};return directive}angular.module("app").directive("nationFilterSearch",nationfilterSearch),nationfilterSearch.$inject=["$ionicModal","CommonRequest","CONFIG"]}(),function(){function occupationCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["invalid","length"];return value?VALIDATION.chineseWordCheck(value)?VALIDATION.stringLengthCheck(value,1,"lt")||VALIDATION.stringLengthCheck(value,61,"gt")?void setValidity("length"):void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("occupationCheck",occupationCheck),occupationCheck.$inject=["VALIDATION"]}(),function(){function zipcodeCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.chineseCheck(value)||!VALIDATION.invalidStringCheck(value)?ngModel.$setValidity("invalid",!1):(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,8,"lt")?ngModel.$setValidity("length",!1):ngModel.$setValidity("length",!0))):(ngModel.$setValidity("invalid",!0),void ngModel.$setValidity("length",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("netcodeCheck",zipcodeCheck),zipcodeCheck.$inject=["VALIDATION"]}(),function(){function onBlur(){function linkFunc(scope,element,attr){element.on("focus",function(e){this.blur()})}var directive={restrict:"A",require:"?ngModel",link:linkFunc};return directive}angular.module("app").directive("onBlur",onBlur),onBlur.$inject=[]}(),function(){function onFocus($timeout){function linkFunc(scope,element,attr){var time=$timeout(function(){element[0].focus(),$timeout.cancel(time)},50)}var directive={restrict:"A",require:"?ngModel",link:linkFunc};return directive}angular.module("app").directive("onFocus",onFocus),onFocus.$inject=["$timeout"]}(),function(){function passwordCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.passwordCheck(value)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,8,"gt")&&VALIDATION.stringLengthCheck(value,16,"lt")?ngModel.$setValidity("length",!0):ngModel.$setValidity("length",!1)):ngModel.$setValidity("invalid",!1)):(ngModel.$setValidity("invalid",!0),void ngModel.$setValidity("length",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("passwordCheck",passwordCheck),passwordCheck.$inject=["VALIDATION"]}(),function(){function phoneCodeCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.numberCheck(value)?(ngModel.$setValidity("invalid",!1),ngModel.$setValidity("length",!0)):(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,6,"=")?ngModel.$setValidity("length",!0):ngModel.$setValidity("length",!1))):(ngModel.$setValidity("invalid",!0),void ngModel.$setValidity("length",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("phoneCodeCheck",phoneCodeCheck),phoneCodeCheck.$inject=["VALIDATION"]}(),function(){function phoneCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.phoneCheck(value)?ngModel.$setValidity("invalid",!0):ngModel.$setValidity("invalid",!1)):void ngModel.$setValidity("invalid",!0)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("phoneCheck",phoneCheck),phoneCheck.$inject=["VALIDATION"]}(),function(){function policyCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,20,"gt")?void setValidity("length"):VALIDATION.policyCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("policyCheck",policyCheck),policyCheck.$inject=["VALIDATION"]}(),function(){function policycCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid"];return value?VALIDATION.stringLengthCheck(value,30,"gt")?void setValidity("length"):VALIDATION.policyCheck(value)?void setValidity():void setValidity("invalid"):void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("policycCheck",policycCheck),policycCheck.$inject=["VALIDATION"]}(),function(){function productDialog(){return{restrict:"E",transclude:!0,scope:{},templateUrl:"app/components/product-dialog/product-dialog.html"}}angular.module("app").directive("productDialog",productDialog)}(),function(){function prdDetailTipController($state,$rootScope,$ionicLoading,CONFIG,CommonRequest,$scope,COMMON,PolicyService,$ionicModal,$timeout,$filter,TipService){var vm=this;vm.id=$state.params.id,$scope.isChecked=!1,$scope.notChecked=!1,"812"==CONFIG.SALE_CHANNEL?$scope.msg="您即将进入投保流程，本产品由建信人寿保险股份有限公司承保，中国建设银行仅提供支持服务。为保障您的权益，请您认真阅读投保页面中的各项信息内容，同时您的操作轨迹将被记录，谢谢！":$scope.msg="您即将进入投保流程，本产品由建信人寿保险股份有限公司承保。为保障您的权益，请您认真阅读投保页面中的各项信息内容，同时您的操作轨迹将被记录，谢谢！",$scope.nextPage=function(){$scope.isChecked?$rootScope.showProductDialog&&($rootScope.showProductDialog=!1):($scope.notChecked=!0,$timeout(function(){$scope.notChecked=!1},1500))},$scope.checkMaterial=function(){$scope.isChecked?$scope.isChecked=!1:($scope.isChecked=!0,$scope.readMaterial())},$scope.readMaterial=function(){var params={prdId:vm.id,materialType:"M6",materialTypeDesc:"建信人寿隐私政策"};vm.materials=[];var material=[];CommonRequest.request(params,CONFIG.GET_MATRRIAL_DETAIL_SERVICE,function(result){if(1==result.status&&(material=result.data,material&&material.length>0)){for(var i=0;i<material.length;i++)material[i].materialPath=CONFIG.IMAGE_SERVICE_ADDRESS+material[i].materialPath,material[i].isRead=!1,vm.materials.push(material[i]);vm.showMaterialModal()}})},vm.showMaterialModal=function(){var self=$rootScope,selfScope=$scope;$ionicModal.fromTemplateUrl("app/module/mall/product/product-purchase/product-purchase-info/policy-notice/popup/material.html",{scope:$rootScope,animation:"slide-in-up",backdropClickToClose:!1}).then(function(modal){self.modal=modal,self.modal.show(),self.nowRead=1,self.allNeadRead=vm.materials.length,self.activeMaterial=vm.materials[0],self.materialUrl=vm.materials[0].materialPath,self.hasMaterialCanvans=!1,self.noMaterialPDF=!1,$ionicLoading.show({template:'<ion-spinner icon="bubbles"></ion-spinner>'}),pdfjsLib.getDocument(self.materialUrl).then(function(pdf){if(console.info(65465456465),self.hasMaterialCanvans=!0,
self.noMaterialPDF=!1,$ionicLoading.hide(),vm.pdfDoc=pdf,self.materialsPages=vm.pdfDoc.numPages,self.materialCanvans=[],self.materialsPages){for(var i=1;i<=self.materialsPages;i++)self.materialCanvans.push(i);$timeout(function(){vm.renderPage(1)},300)}},function(e){console.info(e),self.noMaterialPDF=!0,self.hasMaterialCanvans=!0,$ionicLoading.hide()}),vm.renderPage=function(num){vm.pdfDoc.getPage(num).then(function(page){var canvas=document.getElementById("the-canvas"+num),ctx=canvas.getContext("2d"),dpr=window.devicePixelRatio||1,bsr=ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1,ratio=dpr/bsr,viewport=page.getViewport(screen.availWidth/page.getViewport(1).width);canvas.width=viewport.width*ratio,canvas.height=viewport.height*ratio,canvas.style.width="100%",ctx.setTransform(ratio,0,0,ratio,0,0);var renderContext={canvasContext:ctx,viewport:viewport};page.render(renderContext),self.materialsPages>num&&vm.renderPage(num+1)})},self.readMateril=function(){selfScope.isChecked=!0,self.modal.remove(),vm.materials[0].isRead=!0},$rootScope.$on("$stateChangeStart",function(event,toState){self.modal.remove()})})}}angular.module("app").controller("prdDetailTipController",prdDetailTipController),prdDetailTipController.$inject=["$state","$rootScope","$ionicLoading","CONFIG","CommonRequest","$scope","COMMON","PolicyService","$ionicModal","$timeout","$filter","TipService"]}(),function(){function productNewDialog(){return{restrict:"E",transclude:!0,scope:{},templateUrl:"app/components/product-new-dialog/product-new-dialog.html"}}angular.module("app").directive("productNewDialog",productNewDialog)}(),function(){function prdNewDetailTipController($state,$rootScope,$ionicLoading,CONFIG,CommonRequest,$scope,COMMON,PolicyService,$ionicModal,$timeout,$filter,TipService){var vm=this;vm.id=$state.params.id,"812"==CONFIG.SALE_CHANNEL?$scope.msg="您即将进入投保流程，本产品由建信人寿保险股份有限公司承保，中国建设银行仅提供支持服务。为保障您的权益，请您认真阅读投保页面中的各项信息内容，同时您的操作轨迹将被记录，谢谢！":$scope.msg="您即将进入投保流程，本产品由建信人寿保险股份有限公司承保。为保障您的权益，请您认真阅读投保页面中的各项信息内容，同时您的操作轨迹将被记录，谢谢！",$scope.nextPage=function(){$rootScope.showProductDialog&&($rootScope.showProductDialog=!1)}}angular.module("app").controller("prdNewDetailTipController",prdNewDetailTipController),prdNewDetailTipController.$inject=["$state","$rootScope","$ionicLoading","CONFIG","CommonRequest","$scope","COMMON","PolicyService","$ionicModal","$timeout","$filter","TipService"]}(),function(){function rebanknoCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){function check(firstModel,confirmModel){var confirmPassword=firstModel.replace(/\s+/g,"");confirmPassword?(ngModel.$setValidity("banknoFirst",!0),confirmPassword!=confirmModel.replace(/\s+/g,"")?ngModel.$setValidity("same",!1):(ngModel.$setValidity("same",!0),VALIDATION.banknoCheck(confirmModel)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(confirmModel,13,"lt")||VALIDATION.stringLengthCheck(confirmModel,28,"gt")?ngModel.$setValidity("length",!1):ngModel.$setValidity("length",!0)):ngModel.$setValidity("invalid",!1))):ngModel.$setValidity("banknoFirst",!1)}attr.$observe("bankno",function(){if(ngModel.$viewValue){var confirmBankNo=ngModel.$viewValue,bankNo=attr.bankno;check(bankNo,confirmBankNo)}}),scope.$watch(attr.ngModel,function(value){return value?void check(attr.bankno,value):(ngModel.$setValidity("invalid",!0),ngModel.$setValidity("length",!0),ngModel.$setValidity("same",!0),void ngModel.$setValidity("banknoFirst",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("rebanknoCheck",rebanknoCheck),rebanknoCheck.$inject=["VALIDATION"]}(),function(){function remedicalCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){function check(firstModel,confirmModel){var confirmPassword=firstModel;confirmPassword?(ngModel.$setValidity("banknoFirst",!0),confirmPassword!=confirmModel?ngModel.$setValidity("same",!1):(ngModel.$setValidity("same",!0),VALIDATION.banknoCheck(confirmModel)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(confirmModel,31,"gt")?ngModel.$setValidity("length",!1):ngModel.$setValidity("length",!0)):ngModel.$setValidity("invalid",!1))):ngModel.$setValidity("banknoFirst",!1)}attr.$observe("medicalno",function(){if(ngModel.$viewValue){var confirmBankNo=ngModel.$viewValue,bankNo=attr.medicalno;check(bankNo,confirmBankNo)}}),scope.$watch(attr.ngModel,function(value){return value?void check(attr.medicalno,value):(ngModel.$setValidity("invalid",!0),ngModel.$setValidity("length",!0),ngModel.$setValidity("same",!0),void ngModel.$setValidity("banknoFirst",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("remedicalCheck",remedicalCheck),remedicalCheck.$inject=["VALIDATION"]}(),function(){function referralnoCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.wordCheck(value)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,30,"lt")?ngModel.$setValidity("length",!0):ngModel.$setValidity("length",!1)):ngModel.$setValidity("invalid",!1)):void ngModel.$setValidity("invalid",!0)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("referralnoCheck",referralnoCheck),referralnoCheck.$inject=["VALIDATION"]}(),function(){function repasswordCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){if(!value)return ngModel.$setValidity("invalid",!0),ngModel.$setValidity("length",!0),ngModel.$setValidity("same",!0),void ngModel.$setValidity("passwordFirst",!0);var confirmPassword=attr.password;confirmPassword?(ngModel.$setValidity("passwordFirst",!0),confirmPassword!=value?ngModel.$setValidity("same",!1):(ngModel.$setValidity("same",!0),VALIDATION.passwordCheck(value)?(ngModel.$setValidity("invalid",!0),VALIDATION.stringLengthCheck(value,8,"gt")?ngModel.$setValidity("length",!0):ngModel.$setValidity("length",!1)):ngModel.$setValidity("invalid",!1))):ngModel.$setValidity("passwordFirst",!1)})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("repasswordCheck",repasswordCheck),repasswordCheck.$inject=["VALIDATION"]}(),function(){function riskDetailCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){function setValidity(type){for(var i=0;i<typeArray.length;i++)ngModel.$setValidity(typeArray[i],!0);type&&-1!=typeArray.indexOf(type)&&ngModel.$setValidity(type,!1)}var typeArray=["length","invalid","smallnumber"];return value?VALIDATION.stringLengthCheck(value,201,"gt")?void setValidity("length"):VALIDATION.riskDetailTwoCheck(value)?void setValidity("invalid"):VALIDATION.riskDetailCheck(value)?void setValidity("smallnumber"):void setValidity():void setValidity()})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("riskDetailCheck",riskDetailCheck),riskDetailCheck.$inject=["VALIDATION"]}(),function(){function securityCode($compile,$timeout,CommonRequest,CONFIG,$rootScope){function linkFunc(scope,elem,attrs){function timedCount(){scope.duration<=0?(clearTimeout(time),elem.removeAttr("disabled"),elem.html("重新获取")):time=$timeout(function(){scope.duration--,angular.element(elem).html(scope.duration+"秒重发"),timedCount()},1e3)}function countDown(){elem.attr("disabled","disabled"),scope.duration=attrs.duration,timedCount()}var time;elem.bind("click",function(){var flag,params={mobileNo:attrs.mobileno,imageCode:attrs.imagecode,random:attrs.random,txCode:attrs.txcode};CommonRequest.request(params,CONFIG.SEND_FORGET_MSG_SERVICE,function(result){result&&(1==result.status?(countDown(),flag=!0):flag=!1,$rootScope.$broadcast("send-result",{result:flag}))})})}var directive={restrict:"A",scope:{duration:"@"},link:linkFunc};return directive}angular.module("app").directive("securityCode",securityCode),securityCode.$inject=["$compile","$timeout","CommonRequest","CONFIG","$rootScope"]}(),function(){function selectAgePicker($filter,$rootScope,CommonRequest,$timeout){function linkFunc(scope,element,attr,ngModel){var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){});var calendar;scope.isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)},scope.setSelectValue=function(newValue){var str=scope.getSelectValue(newValue);if(str){var index=scope.getSelectIndex(newValue);calendar.locatePosition(0,index),ngModel&&(ngModel.$setViewValue(str),ngModel.$render())}else var timer=$timeout(function(){scope.setSelectValue(newValue),$timeout.cancel(timer)},300)},scope.getSelectValue=function(val){var str="";if(scope.selctData&&scope.isArray(scope.selctData))for(var i=0;i<scope.selctData.length;i++)if(scope.selctData[i].id==val){str=scope.selctData[i].label;break}return str},scope.getSelectIndex=function(val){var index=-1;if(scope.selctData&&scope.isArray(scope.selctData))for(var i=0;i<scope.selctData.length;i++)if(scope.selctData[i].id==val){index=i;break}return index},scope.callBack=function(indexArr,data){var str=data[0].label;scope.id=data[0].id,ngModel&&(ngModel.$setViewValue(str),ngModel.$render()),scope.eventName&&"[object String]"===Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&scope.$emit(scope.eventName,data)},scope.$on("$destroy",function(){calendar&&(calendar.destory(),calendar=null)}),scope.initData=function(){scope.eventName=attr.selectAgePicker,scope.eventName&&"[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("select-age-picker arguments must be String type and the value can not null"),calendar=new PickerExtend({title:"职业类型",trigger:element[0],speed:2,activeClass:scope.pickerClass,wheels:[{data:scope.selctData}],onHide:function(){scope.setSelectValue(scope.id)},callback:function(indexArr,data){scope.callBack(indexArr,data)}}),scope.$watch("data",function(newValue,oldVlaue){newValue&&calendar&&scope.isArray(newValue)&&(scope.selctData=newValue.map(function(val){var obj=JSON.parse(JSON.stringify(val));return val.id||(obj.id=val.value),obj.value=val.label,obj}),calendar.updateWheel(0,scope.selctData))},!0),scope.setSelectValue(scope.id),scope.$watch("id",function(newValue,oldVlaue){newValue&&newValue!=oldVlaue&&scope.setSelectValue(newValue)},!0)},scope.init=function(){scope.data&&scope.id?(scope.selctData=scope.data.map(function(val){var obj=JSON.parse(JSON.stringify(val));return val.id||(obj.id=val.value),obj.value=val.label,obj}),scope.initData()):$timeout(function(){scope.init()},300)},scope.init(),rootScope.$on("$stateChangeStart",function(event,toState){calendar&&(calendar.destory(),calendar=null)})}var directive={restrict:"A",require:"?ngModel",scope:{data:"=ageData",id:"@ageId"},link:linkFunc};return directive}angular.module("app").directive("selectAgePicker",selectAgePicker),selectAgePicker.$inject=["$filter","$rootScope","CommonRequest","$timeout"]}(),function(){function securityDragCode($compile,$timeout,CommonRequest,CONFIG,$rootScope){function linkFunc(scope,elem,attrs){function timedCount(){scope.duration<=0?(clearTimeout(time),elem.removeAttr("disabled"),elem.html("重新获取")):time=$timeout(function(){scope.duration--,angular.element(elem).html(scope.duration+"S"),timedCount()},1e3)}function countDown(){elem.attr("disabled","disabled"),scope.duration=attrs.duration,timedCount()}var time,imagecode;$rootScope.$on("drag-down",function(event,result){imagecode=result.position}),elem.bind("click",function(){attrs.mobileno=attrs.mobileno.replace(/\s+/g,"");var flag,params={mobileNo:attrs.mobileno,imageCode:imagecode,random:attrs.random,txCode:attrs.txcode};CommonRequest.request(params,CONFIG.SEND_FORGET_MSG_SERVICE,function(result){result&&(1==result.status?(countDown(),flag=!0):flag=!1,$rootScope.$broadcast("send-drag-result",{result:flag}))})})}var directive={restrict:"A",scope:{duration:"@"},link:linkFunc};return directive}angular.module("app").directive("securityDragCode",securityDragCode),securityDragCode.$inject=["$compile","$timeout","CommonRequest","CONFIG","$rootScope"]}(),function(){function selectArea($ionicModal,CommonRequest,CONFIG){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-area/select-area.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.cities=[],scope.counties=[],scope.modal.hide()},scope.showModal=function(){scope.areas=scope.provinces,scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedArea.length?(scope.areas=areaHistory.pop(),selectedArea.pop(),selectedAreaCode.pop(),scope.cities=[],scope.counties=[]):scope.hideModal()},scope.selectArea=function(area){var params={},level=1;area&&area.areaCode?(level=parseInt(area.areaLevel)+1,params={parentAreaCode:area.areaCode,areaLevel:level}):params={},CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){if(1==result.status&&(area?2==level?scope.cities=result.data:3==level&&(scope.counties=result.data):scope.provinces=result.data),area)if(selectedArea.push(area),areaHistory.push(scope.areas),2==level)scope.areas=scope.cities;else if(3==level)scope.areas=scope.counties;else if(ngModel){var areaNames=[],areaCodes=[];angular.forEach(selectedArea,function(area){areaNames.push(area.areaName)}),angular.forEach(selectedArea,function(area){areaCodes.push(area.areaCode)}),ngModel.$setViewValue(areaNames.join("-")),ngModel.$render(),scope.$emit("select-area-close",selectedArea),scope.hideModal()}})},scope.selectArea(),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectedArea:"=selectArea"},link:linkFunc};return directive}angular.module("app").directive("selectArea",selectArea),selectArea.$inject=["$ionicModal","CommonRequest","CONFIG"]}(),function(){function selectAreaGroup($ionicModal,CommonRequest,CONFIG,$rootScope){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedAreaGroup=[],selectedAreaGroupCode=[];$ionicModal.fromTemplateUrl("app/components/select-area-group/select-area-group.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedAreaGroup=[],selectedAreaGroupCode=[],areaHistory=[],scope.cities=[],scope.counties=[],scope.modal.hide()},scope.showModal=function(){scope.areas=scope.provinces,scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedAreaGroup.length?(scope.areas=areaHistory.pop(),selectedAreaGroup.pop(),selectedAreaGroupCode.pop(),scope.cities=[],scope.counties=[]):scope.hideModal()},scope.selectAreaGroup=function(area){var params={},level=1;area&&area.areaCode?(level=parseInt(area.areaLevel)+1,params={parentAreaCode:area.areaCode,areaLevel:level,prdId:$rootScope.prdId}):params={prdId:$rootScope.prdId};var request;request=area?CONFIG.GET_DISTRICT_LEVEL_SECOND_SERVCIE:CONFIG.GET_DISTRICT_LEVEL_FIRST_SERVCIE,CommonRequest.request(params,request,function(result){if(1==result.status&&(area?2==level?scope.cities=result.data:3==level&&(scope.counties=result.data):scope.provinces=result.data),area)if(selectedAreaGroup.push(area),areaHistory.push(scope.areas),2==level)scope.areas=scope.cities;else if(3==level)scope.areas=scope.counties;else if(ngModel){var areaNames=[],areaCodes=[];angular.forEach(selectedAreaGroup,function(area){areaNames.push(area.areaName)}),angular.forEach(selectedAreaGroup,function(area){areaCodes.push(area.areaCode)}),ngModel.$setViewValue(areaNames.join("-")),ngModel.$render(),scope.$emit("select-area-group-close",selectedAreaGroup),scope.hideModal()}})},scope.selectAreaGroup(),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectedAreaGroup:"=selectAreaGroup"},link:linkFunc};return directive}angular.module("app").directive("selectAreaGroup",selectAreaGroup),selectAreaGroup.$inject=["$ionicModal","CommonRequest","CONFIG","$rootScope"]}(),function(){function selectAreaCommon($filter,$rootScope,CommonRequest,$timeout,CONFIG){function linkFunc(scope,element,attr,ngModel){var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){}),scope.eventName=attr.selectAreaCommon,scope.levels=attr.correlateLevel||3,"[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("selectAreaCommon arguments must be String type and the value can not null");var allArr,provinceData=[{id:"",value:""}],cityData=provinceData.map(function(val){return val}),countyData=provinceData.map(function(val){return val});allArr=1==scope.levels?[{data:provinceData}]:2==scope.levels?[{data:provinceData},{data:cityData}]:[{data:provinceData},{data:cityData},{data:countyData}],scope.position=[0,0,0],scope.touchNum=-1,scope.pickerClass=attr.cityPickerClass||"",scope.touchSpeed=attr.cityPickerSpeed,isNaN(parseFloat(scope.touchSpeed))?scope.touchSpeed="":scope.touchSpeed=parseFloat(scope.touchSpeed);var calendar=new PickerExtend({title:"城市选择",trigger:element[0],speed:scope.touchSpeed,activeClass:scope.pickerClass,wheels:allArr,transitionEnd:function(indexArr,data){scope.change(indexArr,data)},callback:function(indexArr,data){scope.callBack(indexArr,data)}});scope.getDistrictLevel1=function(){var params={};CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){1==result.status&&scope.isArray(result.data)&&(provinceData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(0,provinceData),scope.levels>1&&scope.getDistrictLevel2(provinceData[0]))})},scope.isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)},scope.getDistrictLevel2=function(obj){var params={parentAreaCode:obj.areaCode,areaLevel:2};CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){1==result.status&&scope.isArray(result.data)&&(cityData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(1,cityData),calendar.locatePosition(1,0),scope.levels>2&&scope.getDistrictLevel3(provinceData[scope.position[0]],cityData[0]))})},scope.getDistrictLevel3=function(obj1,obj2){var params={parentAreaCode:obj2.areaCode,areaLevel:3};CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){1==result.status&&scope.isArray(result.data)&&(countyData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(2,countyData),calendar.locatePosition(2,0))})},scope.change=function(indexArr,data){indexArr[0]!=scope.position[0]?scope.levels>1&&(this.getDistrictLevel2(data[0]),scope.touchNum=0):indexArr[1]!=scope.position[1]?scope.levels>2&&(this.getDistrictLevel3(data[0],data[1]),scope.touchNum=1):scope.touchNum=2,scope.position=indexArr.map(function(val){return val})},scope.callBack=function(indexArr,data){var str;str=1==scope.levels?data[0].areaName:2==scope.levels?data[0].areaName+"-"+data[1].areaName:data[0].areaName+"-"+data[1].areaName+"-"+data[2].areaName,ngModel&&(ngModel.$setViewValue(str),ngModel.$render()),"[object String]"===Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&scope.$emit(scope.eventName,data)},scope.getDistrictLevel1(),scope.$on("$destroy",function(){calendar&&(calendar.destory(),calendar=null)}),rootScope.$on("$stateChangeStart",function(event,toState){calendar&&(calendar.destory(),calendar=null)})}var directive={restrict:"A",require:"?ngModel",scope:{},link:linkFunc};return directive}angular.module("app").directive("selectAreaCommon",selectAreaCommon),selectAreaCommon.$inject=["$filter","$rootScope","CommonRequest","$timeout","CONFIG"]}(),function(){function selectAreaPicker($filter,$rootScope,CommonRequest,$timeout,CONFIG){function linkFunc(scope,element,attr,ngModel){var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){}),scope.eventName=attr.selectAreaPicker,"[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("select-area-picker arguments must be String type and the value can not null");var provinceData=[{id:"",value:""}],cityData=provinceData.map(function(val){return val}),countyData=provinceData.map(function(val){return val});scope.position=[0,0,0],scope.touchNum=-1;var calendar=new PickerExtend({title:"城市选择",trigger:element[0],wheels:[{data:provinceData},{data:cityData},{data:countyData}],transitionEnd:function(indexArr,data){scope.change(indexArr,data)},callback:function(indexArr,data){scope.callBack(indexArr,data)}});scope.getDistrictLevel1=function(){var params={prdId:$rootScope.prdId},config=CONFIG.GET_DISTRICT_LEVEL_FIRST_SERVCIE;CommonRequest.request(params,config,function(result){1==result.status&&scope.isArray(result.data)&&(provinceData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(0,provinceData),scope.getDistrictLevel2(provinceData[0]))})},scope.isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)},scope.getDistrictLevel2=function(obj){var config=CONFIG.GET_DISTRICT_LEVEL_SECOND_SERVCIE,params={parentAreaCode:obj.areaCode,areaLevel:2,prdId:$rootScope.prdId};CommonRequest.request(params,config,function(result){1==result.status&&scope.isArray(result.data)&&(cityData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(1,cityData),calendar.locatePosition(1,0),scope.getDistrictLevel3(provinceData[scope.position[0]],cityData[0]))})},scope.getDistrictLevel3=function(obj1,obj2){var config=CONFIG.GET_DISTRICT_LEVEL_SECOND_SERVCIE,params={parentAreaCode:obj2.areaCode,areaLevel:3,prdId:$rootScope.prdId};CommonRequest.request(params,config,function(result){1==result.status&&scope.isArray(result.data)&&(countyData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(2,countyData),calendar.locatePosition(2,0))})},scope.change=function(indexArr,data){indexArr[0]!=scope.position[0]?(this.getDistrictLevel2(data[0]),scope.touchNum=0):indexArr[1]!=scope.position[1]?(this.getDistrictLevel3(data[0],data[1]),scope.touchNum=1):scope.touchNum=2,scope.position=indexArr.map(function(val){return val})},scope.callBack=function(indexArr,data){var str=data[0].areaName+"-"+data[1].areaName+"-"+data[2].areaName;ngModel&&(ngModel.$setViewValue(str),ngModel.$render()),"[object String]"===Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&scope.$emit(scope.eventName,data)},scope.getDistrictLevel1(),scope.$on("$destroy",function(){calendar&&(calendar.destory(),calendar=null)}),rootScope.$on("$stateChangeStart",function(event,toState){calendar&&(calendar.destory(),calendar=null)})}var directive={restrict:"A",require:"?ngModel",scope:{},link:linkFunc};return directive}angular.module("app").directive("selectAreaPicker",selectAreaPicker),selectAreaPicker.$inject=["$filter","$rootScope","CommonRequest","$timeout","CONFIG"]}(),function(){function selectAreaTotal($filter,$rootScope,CommonRequest,$timeout,CONFIG){function linkFunc(scope,element,attr,ngModel){function addFull(arr){"[object Array]"===Object.prototype.toString.call(arr)&&arr.unshift({areaName:"全部",value:"全部",areaCode:"full",id:"full"})}function addSelect(arr){"[object Array]"===Object.prototype.toString.call(arr)&&arr.unshift({areaName:"请选择",value:"请选择",areaCode:"select",id:"select"})}function isSpecial(){var str="",key1="请选择",key2="全部",name1="",name2="",name3="";return arguments[0]&&(name1=arguments[0].areaName==key1||arguments[0].areaName==key2?"":arguments[0].areaName),arguments[1]&&(name2=arguments[1].areaName==key1||arguments[1].areaName==key2?"":arguments[1].areaName),arguments[2]&&(name3=arguments[2].areaName==key1||arguments[2].areaName==key2?"":arguments[2].areaName),1===arguments.length?str=name1:2===arguments.length?name1&&name2?str=name1+"-"+name2:name1&&!name2&&(str=name1):3===arguments.length&&(name1&&name2&&name3?str=name1+"-"+name2+"-"+name3:name2&&!name3?str=name1+"-"+name2:name1&&!name2&&(str=name1)),str}var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){}),scope.eventName=attr.selectAreaTotal,scope.levels=attr.correlateLevel||3,scope.full=attr.areaFull||"",scope.isEmpty=attr.areaIsEmpty||"","[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("selectAreaTotal arguments must be String type and the value can not null");var allArr,provinceData=[{id:"",value:""}],cityData=provinceData.map(function(val){return val}),countyData=provinceData.map(function(val){return val});allArr=1==scope.levels?[{data:provinceData}]:2==scope.levels?[{data:provinceData},{data:cityData}]:[{data:provinceData},{data:cityData},{data:countyData}],scope.position=[0,0,0],scope.touchNum=-1,scope.pickerClass=attr.cityPickerClass||"",scope.touchSpeed=attr.cityPickerSpeed,isNaN(parseFloat(scope.touchSpeed))?scope.touchSpeed="":scope.touchSpeed=parseFloat(scope.touchSpeed);var calendar=new PickerExtend({title:"城市选择",trigger:element[0],speed:scope.touchSpeed,activeClass:scope.pickerClass,wheels:allArr,transitionEnd:function(indexArr,data){scope.change(indexArr,data)},callback:function(indexArr,data){scope.callBack(indexArr,data)}});scope.getDistrictLevel1=function(){var params={};CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){1==result.status&&scope.isArray(result.data)&&(provinceData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),(scope.isEmpty||scope.full)&&addSelect(provinceData),calendar.updateWheel(0,provinceData),scope.levels>1&&("select"==provinceData[0].areaCode?scope.fullChange(1):scope.getDistrictLevel2(provinceData[0])))})},scope.isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)},scope.getDistrictLevel2=function(obj){var params={parentAreaCode:obj.areaCode,areaLevel:2};CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){1==result.status&&scope.isArray(result.data)&&(cityData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),scope.full&&addFull(cityData),scope.isEmpty&&addSelect(cityData),calendar.updateWheel(1,cityData),calendar.locatePosition(1,0),scope.levels>2&&("select"==cityData[0].areaCode||"full"==cityData[0].areaCode?scope.fullChange(2):scope.getDistrictLevel3(provinceData[scope.position[0]],cityData[0])))})},scope.getDistrictLevel3=function(obj1,obj2){var params={parentAreaCode:obj2.areaCode,areaLevel:3};CommonRequest.request(params,CONFIG.GET_AREA_SERVCIE,function(result){1==result.status&&scope.isArray(result.data)&&(countyData=result.data.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),scope.full&&addFull(countyData),scope.isEmpty&&addSelect(countyData),calendar.updateWheel(2,countyData),calendar.locatePosition(2,0))})},scope.change=function(indexArr,data){indexArr[0]!=scope.position[0]?scope.levels>1&&("select"==data[0].areaCode||"full"==data[0].areaCode?scope.fullChange(1):this.getDistrictLevel2(data[0]),scope.touchNum=0):indexArr[1]!=scope.position[1]?scope.levels>2&&("select"==data[1].areaCode||"full"==data[1].areaCode?scope.fullChange(2):this.getDistrictLevel3(data[0],data[1]),scope.touchNum=1):scope.touchNum=2,scope.position=indexArr.map(function(val){return val})},scope.callBack=function(indexArr,data){var str;str=1==scope.levels?isSpecial(data[0]):2==scope.levels?isSpecial(data[0],data[1]):isSpecial(data[0],data[1],data[2]),ngModel&&(ngModel.$setViewValue(str),ngModel.$render()),"[object String]"===Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&scope.$emit(scope.eventName,data)},scope.getDistrictLevel1(),scope.fullChange=function(id){var arr=[];1==id?(addFull(arr),addSelect(arr),calendar.updateWheel(1,arr),calendar.locatePosition(1,0),scope.fullChange(2)):2==id&&(addFull(arr),addSelect(arr),calendar.updateWheel(2,arr),calendar.locatePosition(2,0))},scope.$on("$destroy",function(){calendar&&(calendar.destory(),calendar=null)}),rootScope.$on("$stateChangeStart",function(event,toState){calendar&&(calendar.destory(),calendar=null)})}var directive={restrict:"A",require:"?ngModel",scope:{},link:linkFunc};return directive}angular.module("app").directive("selectAreaTotal",selectAreaTotal),selectAreaTotal.$inject=["$filter","$rootScope","CommonRequest","$timeout","CONFIG"]}(),function(){function selectBranchGroup($ionicModal,CommonRequest,CONFIG){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-branch-group/select-branch-group.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.modal.hide()},scope.showModal=function(){scope.provincecode=attr.provincecode,scope.selectBranchGroup(),scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedArea.length?(scope.areas=areaHistory.pop(),selectedArea.pop(),selectedAreaCode.pop()):scope.hideModal()},scope.selectBranchGroup=function(netName,code,netLevel,areaCode){if(netLevel)var level=parseInt(netLevel)+1;var params={};params=code&&level?{parentNetCode:code,netLevel:level}:{},CommonRequest.request(params,CONFIG.GET_NETPOINTLIST_SERVCIE,function(result){if(1==result.status)if(level)2==level?scope.cityMarks=result.data:scope.areaMarks=result.data;else if(scope.provinceMarkList=result.data,scope.provinceMarks=[],scope.provinceMarkList&&scope.provinceMarkList.length>0){for(var i=0;i<scope.provinceMarkList.length;i++)scope.provinceMarkList[i].netCode==scope.provincecode&&scope.provinceMarks.push(scope.provinceMarkList[i]);scope.areas=scope.provinceMarks}if(level&&(selectedArea.push({netName:netName,netCode:code}),selectedAreaCode.push(areaCode),areaHistory.push(scope.areas)),2==level)scope.areas=scope.cityMarks;else if(3==level)scope.areas=scope.areaMarks;else if(4==level&&ngModel){var areaNames=[];angular.forEach(selectedArea,function(area){areaNames.push(area.netName)}),ngModel.$setViewValue(areaNames[2]),ngModel.$render(),scope.$emit("select-branch-group-close",selectedArea),scope.hideModal()}})},element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectBranchGroup:"=selectBranchGroup"},link:linkFunc};return directive}angular.module("app").directive("selectBranchGroup",selectBranchGroup),selectBranchGroup.$inject=["$ionicModal","CommonRequest","CONFIG"]}(),function(){function selectBranch($ionicModal,CommonRequest,CONFIG){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-branch/select-branch.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.modal.hide()},scope.showModal=function(){scope.provincecode=attr.provincecode,scope.selectBranch(),scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedArea.length?(scope.areas=areaHistory.pop(),selectedArea.pop(),selectedAreaCode.pop()):scope.hideModal()},scope.selectBranch=function(netName,code,netLevel,areaCode){if(netLevel)var level=parseInt(netLevel)+1;else var level=1;
if(4==level){if(ngModel){selectedArea.push({netName:netName,netCode:code});var areaNames=[];angular.forEach(selectedArea,function(area){areaNames.push(area.netName)}),ngModel.$setViewValue(areaNames[2]),ngModel.$render(),scope.$emit("select-branch-close",selectedArea),scope.hideModal()}}else{var config,params={};params=code&&level?{parentNetCode:code,netLevel:level}:{},1==level?config={url:"../statics/product/netpoints/0/netpoint.json",method:"GET"}:2==level?(scope.province=code,config=config={url:"../statics/product/netpoints/0/"+code+"/netpoint.json",method:"GET"}):3==level&&(config=config={url:"../statics/product/netpoints/0/"+scope.province+"/"+code+"/netpoint.json",method:"GET"}),CommonRequest.request(params,config,function(result){if(1==level){if(scope.provinceMarkList=result,scope.provinceMarks=[],scope.provinceMarkList&&scope.provinceMarkList.length>0){for(var i=0;i<scope.provinceMarkList.length;i++)scope.provinceMarkList[i].netCode==scope.provincecode&&scope.provinceMarks.push(scope.provinceMarkList[i]);scope.areas=scope.provinceMarks}}else 2==level?scope.cityMarks=result:scope.areaMarks=result;level>1&&(selectedArea.push({netName:netName,netCode:code}),selectedAreaCode.push(areaCode),areaHistory.push(scope.areas)),2==level?scope.areas=scope.cityMarks:3==level&&(scope.areas=scope.areaMarks)})}},element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectBranch:"=selectBranch"},link:linkFunc};return directive}angular.module("app").directive("selectBranch",selectBranch),selectBranch.$inject=["$ionicModal","CommonRequest","CONFIG"]}(),function(){function selectCityPicker($filter,$rootScope,CommonRequest,$timeout){function linkFunc(scope,element,attr,ngModel){var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){}),scope.eventName=attr.selectCityPicker,"[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("select-city-picker arguments must be String type and the value can not null");var provinceData=[{id:"",value:""}],cityData=provinceData.map(function(val){return val}),countyData=provinceData.map(function(val){return val});scope.position=[0,0,0],scope.touchNum=-1,scope.pickerClass=attr.cityPickerClass||"",scope.touchSpeed=attr.cityPickerSpeed,isNaN(parseFloat(scope.touchSpeed))?scope.touchSpeed="":scope.touchSpeed=parseFloat(scope.touchSpeed);var calendar=new PickerExtend({title:"城市选择",trigger:element[0],speed:scope.touchSpeed,activeClass:scope.pickerClass,wheels:[{data:provinceData},{data:cityData},{data:countyData}],transitionEnd:function(indexArr,data){scope.change(indexArr,data)},callback:function(indexArr,data){scope.callBack(indexArr,data)}});scope.getDistrictLevel1=function(){var params={prdId:scope.prodata};"Y"==scope.prelnsureFlags?scope.configT={url:"../statics/product/preArea/"+scope.prodata+"/"+scope.prodata+".json",method:"GET"}:scope.configT={url:"../statics/product/areas/"+scope.prodata+"/"+scope.prodata+".json",method:"GET"},CommonRequest.request(params,scope.configT,function(result){scope.isArray(result)&&(provinceData=result.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(0,provinceData),scope.getDistrictLevel2(provinceData[0]))})},scope.isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)},scope.getDistrictLevel2=function(obj){var config={url:"../statics/product/areas/"+scope.prodata+"/"+obj.areaCode+"/"+scope.prodata+".json",method:"GET"},params={prdId:scope.prodata,parentAreaCode:obj.areaCode,areaLevel:2};CommonRequest.request(params,config,function(result){scope.isArray(result)&&(cityData=result.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(1,cityData),calendar.locatePosition(1,0),scope.getDistrictLevel3(provinceData[scope.position[0]],cityData[0]))})},scope.getDistrictLevel3=function(obj1,obj2){var config={url:"../statics/product/areas/"+scope.prodata+"/"+obj1.areaCode+"/"+obj2.areaCode+"/"+scope.prodata+".json",method:"GET"},params={prdId:scope.prodata,parentAreaCode:obj2.areaCode,areaLevel:3};CommonRequest.request(params,config,function(result){scope.isArray(result)&&(countyData=result.map(function(obj){return obj.value=obj.areaName,obj.id=obj.areaCode,obj}),calendar.updateWheel(2,countyData),calendar.locatePosition(2,0))})},scope.change=function(indexArr,data){indexArr[0]!=scope.position[0]?(this.getDistrictLevel2(data[0]),scope.touchNum=0):indexArr[1]!=scope.position[1]?(this.getDistrictLevel3(data[0],data[1]),scope.touchNum=1):scope.touchNum=2,scope.position=indexArr.map(function(val){return val})},scope.callBack=function(indexArr,data){var str=data[0].areaName+"-"+data[1].areaName+"-"+data[2].areaName;ngModel&&(ngModel.$setViewValue(str),ngModel.$render()),"[object String]"===Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&scope.$emit(scope.eventName,data)},scope.getProdata=function(){attr.prodata?("Y"==attr.prodata.slice(-1)?(scope.prodata=attr.prodata.slice(0,attr.prodata.length-1),scope.prelnsureFlags=attr.prodata.slice(-1)):(scope.prodata=attr.prodata,scope.prelnsureFlags="N"),scope.getDistrictLevel1()):$timeout(function(){scope.getProdata()},1e3)},scope.getProdata(),scope.$on("$destroy",function(){calendar&&(calendar.destory(),calendar=null)}),rootScope.$on("$stateChangeStart",function(event,toState){calendar&&(calendar.destory(),calendar=null)})}var directive={restrict:"A",require:"?ngModel",scope:{},link:linkFunc};return directive}angular.module("app").directive("selectCityPicker",selectCityPicker),selectCityPicker.$inject=["$filter","$rootScope","CommonRequest","$timeout"]}(),function(){function selectCountry($ionicModal,CommonRequest,CONFIG,$rootScope){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-country/select-country.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.modal.hide()},scope.showModal=function(){scope.areas=scope.country,scope.modal.show()},scope.returnPreArea=function(){scope.hideModal()},scope.selectArea=function(area){var config={url:"../statics/json/CRScountry.json",method:"GET"};CommonRequest.request({},config,function(result){scope.areas=scope.country=result.data}),scope.country&&scope.country.length>0&&(selectedArea.push(area),ngModel&&(scope.$emit("select-country-close",selectedArea),scope.hideModal()))},scope.selectArea(),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectCountry:"=selectCountry"},link:linkFunc};return directive}angular.module("app").directive("selectCountry",selectCountry),selectCountry.$inject=["$ionicModal","CommonRequest","CONFIG","$rootScope"]}(),function(){function selectCountryNut($ionicModal,CommonRequest,CONFIG,$rootScope){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-country-nut/select-country-nut.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.modal.hide()},scope.showModal=function(){scope.areas=scope.country,scope.modal.show()},scope.returnPreArea=function(){scope.hideModal()},scope.selectArea=function(area){var config={url:"../statics/json/country/coreCountry.json",method:"GET"};CommonRequest.request({},config,function(result){scope.areas=scope.country=result.data[0].others,scope.areatext=scope.areas}),scope.country&&scope.country.length>0&&(selectedArea.push(area),ngModel&&(scope.$emit("select-country-nut-close",selectedArea),scope.hideModal()))},scope.selectArea(),scope.areatext=scope.areas,scope.keyWorldTWO=function(val){var config={url:"../statics/json/country/coreCountry.json",method:"GET"};CommonRequest.request({},config,function(result){scope.areas=scope.country=result.data[0].others,scope.areatext=scope.areas;var arrList=scope.areatext,areaList=[];if(val){for(var i in arrList)for(var k in arrList[i]){var d=arrList[i].countryName.indexOf(val);d>=0&&areaList.indexOf(arrList[i])<0&&areaList.push(arrList[i])}scope.areatext=areaList}else scope.areatext=scope.areas})},scope.keyWorldTWO(),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectCountryNut:"=selectCountryNut"},link:linkFunc};return directive}angular.module("app").directive("selectCountryNut",selectCountryNut),selectCountryNut.$inject=["$ionicModal","CommonRequest","CONFIG","$rootScope"]}(),function(){function selectOccupationPicker($filter,$rootScope,CommonRequest,$timeout){function linkFunc(scope,element,attr,ngModel){var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){});var calendar;scope.isArray=function(arr){return"[object Array]"===Object.prototype.toString.call(arr)},scope.setSelectValue=function(newValue){if(newValue){var str=scope.getSelectValue(newValue);if(str){var index=scope.getSelectIndex(newValue);calendar.locatePosition(0,index),ngModel&&(ngModel.$setViewValue(str),ngModel.$render())}else var timer=$timeout(function(){scope.setSelectValue(newValue),$timeout.cancel(timer)},300)}else ngModel&&(ngModel.$setViewValue(""),ngModel.$render())},scope.getSelectValue=function(val){var str="";if(scope.selctData&&scope.isArray(scope.selctData))for(var i=0;i<scope.selctData.length;i++)if(scope.selctData[i].id==val){str=scope.selctData[i].label;break}return str},scope.getSelectIndex=function(val){var index=-1;if(scope.selctData&&scope.isArray(scope.selctData))for(var i=0;i<scope.selctData.length;i++)if(scope.selctData[i].id==val){index=i;break}return index},scope.callBack=function(indexArr,data){var str=data[0].label;scope.id=data[0].id,ngModel&&(ngModel.$setViewValue(str),ngModel.$render()),scope.eventName&&"[object String]"===Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&scope.$emit(scope.eventName,data)},scope.$on("$destroy",function(){calendar&&(calendar.destory(),calendar=null)}),scope.initData=function(){scope.eventName=attr.selectOccupationPicker,scope.eventName&&"[object String]"!==Object.prototype.toString.call(scope.eventName)&&""!==scope.eventName&&console.error("select-occupation-picker arguments must be String type and the value can not null"),calendar=new PickerExtend({title:"职业类型",trigger:element[0],speed:scope.touchSpeed,activeClass:scope.pickerClass,wheels:[{data:scope.selctData}],callback:function(indexArr,data){scope.callBack(indexArr,data)}}),scope.$watch("data",function(newValue,oldVlaue){newValue&&calendar&&scope.isArray(newValue)&&(scope.selctData=newValue.map(function(val){var obj=JSON.parse(JSON.stringify(val));return val.id||(obj.id=val.value),obj.value=val.label,obj}),calendar.updateWheel(0,scope.selctData))},!0),scope.setSelectValue(scope.id),scope.$watch("id",function(newValue,oldVlaue){newValue&&newValue!=oldVlaue&&scope.setSelectValue(newValue)},!0)},scope.init=function(){scope.data?(scope.selctData=scope.data.map(function(val){var obj=JSON.parse(JSON.stringify(val));return val.id||(obj.id=val.value),obj.value=val.label,obj}),scope.initData()):$timeout(function(){scope.init()},300)},scope.init(),rootScope.$on("$stateChangeStart",function(event,toState){calendar&&(calendar.destory(),calendar=null)})}var directive={restrict:"A",require:"?ngModel",scope:{data:"=occupationData",id:"=occupationValue"},link:linkFunc};return directive}angular.module("app").directive("selectOccupationPicker",selectOccupationPicker),selectOccupationPicker.$inject=["$filter","$rootScope","CommonRequest","$timeout"]}(),function(){function selectPrdCity($ionicModal,CommonRequest,CONFIG,$rootScope,$timeout){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-prdarea/select-prdarea.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.cities=[],scope.counties=[],scope.modal.hide()},scope.showModal=function(){scope.areas=scope.provinces,scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedArea.length?(scope.areas=areaHistory.pop(),selectedArea.pop(),selectedAreaCode.pop(),scope.cities=[],scope.counties=[]):scope.hideModal()},scope.districtLevel1=function(){var params={prdId:scope.prodata},config={url:"../statics/product/areas/"+scope.prodata+"/"+scope.prodata+".json",method:"GET"};CommonRequest.request(params,config,function(result){scope.provinces=result})},scope.districtLevel2=function(area){var config,level=parseInt(area.areaLevel)+1;2==level?(scope.province=area.areaCode,config={url:"../statics/product/areas/"+scope.prodata+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"}):3==level&&(config={url:"../statics/product/areas/"+scope.prodata+"/"+scope.province+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"});var params={prdId:scope.prodata,parentAreaCode:area.areaCode,areaLevel:level};CommonRequest.request(params,config,function(result){2==level?(scope.cities=result,scope.areas=scope.cities):(scope.counties=result,scope.areas=scope.counties)})},scope.selectArea=function(area){if(area?parseInt(area.areaLevel)<3&&scope.districtLevel2(area):scope.districtLevel1(),area&&(selectedArea.push(area),areaHistory.push(scope.areas),scope.cities&&scope.cities.length>0&&ngModel)){var areaNames=[],areaCodes=[];angular.forEach(selectedArea,function(area){areaNames.push(area.areaName)}),angular.forEach(selectedArea,function(area){areaCodes.push(area.areaCode)}),$rootScope.areaCodes=areaCodes.join("-"),ngModel.$setViewValue(areaNames.join("-")),ngModel.$render(),scope.$emit("select-prdarea-close",selectedArea),scope.hideModal()}},scope.getProdata=function(){attr.prodata?(scope.prodata=attr.prodata,scope.selectArea()):$timeout(function(){scope.getProdata()},1e3)},scope.getProdata(),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive={restrict:"A",require:"?ngModel",scope:{selectedPrdArea:"=selectPrdCity"},link:linkFunc};return directive}angular.module("app").directive("selectPrdCity",selectPrdCity),selectPrdCity.$inject=["$ionicModal","CommonRequest","CONFIG","$rootScope","$timeout"]}(),function(){function selectPrdArea($ionicModal,CommonRequest,CONFIG,$rootScope,$timeout,PolicyService){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-prdarea/select-prdarea.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){$timeout(function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.cities=[],scope.counties=[]},500),scope.modal.hide()},scope.showModal=function(){scope.areas=scope.provinces,scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedArea.length?(scope.areas=areaHistory.pop(),selectedArea.pop(),selectedAreaCode.pop(),scope.cities=[],scope.counties=[]):scope.hideModal()},scope.districtLevel1=function(){var params={prdId:scope.prodata},config={url:"../statics/product/areas/"+scope.prodata+"/"+scope.prodata+".json",method:"GET"};CommonRequest.request(params,config,function(result){scope.provinces=result})},scope.districtLevel2=function(area){var level=parseInt(area.areaLevel)+1;console.log();var config;2==level?(scope.province=area.areaCode,config={url:"../statics/product/areas/"+scope.prodata+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"}):3==level&&(config={url:"../statics/product/areas/"+scope.prodata+"/"+scope.province+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"});var params={prdId:scope.prodata,parentAreaCode:area.areaCode,areaLevel:level};CommonRequest.request(params,config,function(result){2==level?(scope.cities=result,scope.areas=scope.cities):(scope.counties=result,scope.areas=scope.counties)})},scope.selectArea=function(area){if(area?parseInt(area.areaLevel)<3&&scope.districtLevel2(area):scope.districtLevel1(),area&&(selectedArea.push(area),areaHistory.push(scope.areas),scope.counties&&scope.counties.length>0&&ngModel)){var areaNames=[],areaCodes=[];angular.forEach(selectedArea,function(area){areaNames.push(area.areaName)}),angular.forEach(selectedArea,function(area){areaCodes.push(area.areaCode)}),$rootScope.areaCodes=areaCodes.join("-"),ngModel.$setViewValue(areaNames.join("-")),ngModel.$render(),void 0!=scope.crsselect?scope.$emit("select-prdarea-close-crs",selectedArea):scope.$emit("select-prdarea-close",selectedArea),scope.hideModal()}},scope.getProdata=function(){attr.prodata?(scope.prodata=attr.prodata,scope.crsselect=attr.crsselect,scope.selectArea()):$timeout(function(){scope.getProdata()},1e3)},scope.getProdata(),$rootScope.$on("$stateChangeStart",function(event,toState){scope.hideModal()}),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var directive=(PolicyService.getSessionData(),{restrict:"A",require:"?ngModel",scope:{selectedPrdArea:"=selectPrdArea"},link:linkFunc});return directive}angular.module("app").directive("selectPrdArea",selectPrdArea),selectPrdArea.$inject=["$ionicModal","CommonRequest","CONFIG","$rootScope","$timeout","PolicyService"]}(),function(){function selectPrdPrearea($ionicModal,CommonRequest,CONFIG,$rootScope,$timeout,PolicyService){function linkFunc(scope,element,attr,ngModel){var areaHistory=[],selectedArea=[],selectedAreaCode=[];$ionicModal.fromTemplateUrl("app/components/select-prdarea/select-prdarea.html",{scope:scope}).then(function(modal){scope.modal=modal}),scope.hideModal=function(){selectedArea=[],selectedAreaCode=[],areaHistory=[],scope.cities=[],scope.counties=[],scope.modal.hide()},scope.showModal=function(){scope.areas=scope.provinces,scope.modal.show()},scope.returnPreArea=function(){0!==areaHistory.length&&0!==selectedArea.length?(scope.areas=areaHistory.pop(),selectedArea.pop(),selectedAreaCode.pop(),scope.cities=[],scope.counties=[]):scope.hideModal()},scope.districtLevel1=function(){var params={prdId:scope.prodata};if("Y"==sessionData.productData.prelnsureFlag)var config={url:"../statics/product/preArea/"+scope.prodata+"/"+scope.prodata+".json",method:"GET"};else var config={url:"../statics/product/areas/"+scope.prodata+"/"+scope.prodata+".json",method:"GET"};CommonRequest.request(params,config,function(result){scope.provinces=result})},scope.districtLevel2=function(area){var config,level=parseInt(area.areaLevel)+1;"Y"==sessionData.productData.prelnsureFlag?2==level?(scope.province=area.areaCode,config={url:"../statics/product/preArea/"+scope.prodata+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"}):3==level&&(config={url:"../statics/product/preArea/"+scope.prodata+"/"+scope.province+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"}):2==level?(scope.province=area.areaCode,config={url:"../statics/product/areas/"+scope.prodata+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"}):3==level&&(config={url:"../statics/product/areas/"+scope.prodata+"/"+scope.province+"/"+area.areaCode+"/"+scope.prodata+".json",method:"GET"});var params={prdId:scope.prodata,parentAreaCode:area.areaCode,areaLevel:level};CommonRequest.request(params,config,function(result){2==level?(scope.cities=result,scope.areas=scope.cities):(scope.counties=result,scope.areas=scope.counties)})},scope.selectArea=function(area){if(area?parseInt(area.areaLevel)<3&&scope.districtLevel2(area):scope.districtLevel1(),area&&(selectedArea.push(area),areaHistory.push(scope.areas),scope.counties&&scope.counties.length>0&&ngModel)){var areaNames=[],areaCodes=[];angular.forEach(selectedArea,function(area){areaNames.push(area.areaName)}),angular.forEach(selectedArea,function(area){areaCodes.push(area.areaCode)}),$rootScope.areaCodes=areaCodes.join("-"),ngModel.$setViewValue(areaNames.join("-")),ngModel.$render(),void 0!=scope.crsselect?scope.$emit("select-prdarea-close-crs",selectedArea):scope.$emit("select-prdarea-close",selectedArea),scope.hideModal()}},scope.getProdata=function(){attr.prodata?(scope.prodata=attr.prodata,scope.crsselect=attr.crsselect,scope.selectArea()):$timeout(function(){scope.getProdata()},1e3)},scope.getProdata(),$rootScope.$on("$stateChangeStart",function(event,toState){scope.hideModal()}),element.on("click",scope.showModal),element.attr("readonly","readonly"),element.css("background-color","#fff"),scope.$on("$destroy",function(){scope.modal.remove(),element.off("click",scope.showModal)})}var sessionData=PolicyService.getSessionData(),directive={restrict:"A",require:"?ngModel",scope:{selectedPrdArea:"=selectPrdArea"},link:linkFunc};return directive}angular.module("app").directive("selectPrdPrearea",selectPrdPrearea),selectPrdPrearea.$inject=["$ionicModal","CommonRequest","CONFIG","$rootScope","$timeout","PolicyService"]}(),function(){function zipcodeCheck(VALIDATION){function linkFunc(scope,elem,attr,ngModel){scope.$watch(attr.ngModel,function(value){return value?void(VALIDATION.zipcodeCheck(value)?ngModel.$setValidity("invalid",!0):ngModel.$setValidity("invalid",!1)):(ngModel.$setValidity("invalid",!0),void ngModel.$setValidity("length",!0))})}var directive={restrict:"A",require:"ngModel",link:linkFunc};return directive}angular.module("app").directive("zipcodeCheck",zipcodeCheck),zipcodeCheck.$inject=["VALIDATION"]}(),function(){function timePicker($filter,$rootScope){function linkFunc(scope,element,attr){var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(){});var calendar=new lCalendar,maxDate=attr.maxdate,minDate=attr.mindate,now=new Date;if(now=$filter("date")(now,"yyyy-MM-dd"),now=new Date(now),maxDate){var maxlength=maxDate.split(".").length;if(2==maxlength)var maxtime=$filter("date")(scope[maxDate.split(".")[0]][maxDate.split(".")[1]],"yyyy-MM-dd");else if(1==maxlength){scope[maxDate]=maxDate;var maxtime=$filter("date")(scope[maxDate],"yyyy-MM-dd")}var maxChooseTime=new Date(maxtime);maxChooseTime.getTime()<now.getTime()&&(now=maxChooseTime)}else var maxtime="2099-12-31";if(minDate){var minlength=minDate.split(".").length;if(2==minlength)var mintime=$filter("date")(scope[minDate.split(".")[0]][minDate.split(".")[1]],"yyyy-MM-dd");else if(1==minlength){scope[minDate]=minDate;var mintime=$filter("date")(scope[minDate],"yyyy-MM-dd")}var minChooseTime=new Date(mintime);minChooseTime.getTime()>now.getTime()&&(now=minChooseTime)}else var mintime="1900-01-01";calendar.init({trigger:element[0],type:"date",max:maxtime,min:mintime,chooseTime:now});var rootScope=$rootScope;rootScope.$on("$stateChangeStart",function(event,toState){calendar.gearDate&&calendar.gearDate.remove(".gearDate")})}var directive={restrict:"A",require:"?ngModel",link:linkFunc};return directive}angular.module("app").directive("timePicker",timePicker),timePicker.$inject=["$filter","$rootScope"]}();